{
  "type": "object",
  "title": "Swissubase to CESSDA metadata mappings",
  "subTargetSchema": "http://www.ddialliance.org/Specification/DDI-Codebook/2.5/XMLSchema/codebook.xsd",
  "subTargetSchemaNamespace": "ddi:codebook:2_5",
  "subTargetSchemaNotes": "Implements a ddi codebook 2.5 subset: https://cmv.cessda.eu/profiles/cdc/ddi-2.5/1.0.4/profile.xml",
  "subMappingsVersion": "1.0",
  "subIdentifier": "oai_ddi25",
  "required": ["codeBook"],
  "properties": {
    "codeBook": {
      "type": "object",
      "subNodePath": "codeBook",
      "subNodeAttributes": [
        {"subAttributeName": "xmlns", "subDefaultValue": "ddi:codebook:2_5"},
        {"subAttributeName": "version", "subDefaultValue": "2.5"},
        {"subAttributeName": "xsi:schemaLocation", "subDefaultValue": "ddi:codebook:2_5 http://www.ddialliance.org/Specification/DDI-Codebook/2.5/XMLSchema/codebook.xsd"}
      ],
      "subCallbackMethod": ["getLanguageCode"],
      "required": ["stdyDscr"],
      "properties": {
        "datasetTitle": {
          "$comment": "Use ISO 639-1 for language identifier",
          "type": "object",
          "subNodePath": "docDscr/citation/titlStmt/titl",
          "subNodeAttributes": [
            {"subAttributeName": "xml:lang", "subRequired":  true}
          ],
          "subTargetFields": {"translationsPath": "title", "languagePath": "language/code"},
          "subCallbackMethod": ["getMainTranslation"]
        },
        "stdyDscr": {
          "type": "object",
          "subNodePath": "stdyDscr",
          "required": ["citation"],
          "properties": {
            "citation": {
              "type": "object",
              "subNodePath": "citation",
              "required": ["titlStmt", "datasetURLs"],
              "properties": {
                "titlStmt": {
                  "type": "object",
                  "subNodePath": "titlStmt",
                  "required": ["datasetTitle", "datasetDOI"],
                  "properties": {
                    "datasetTitle": {
                      "$comment": "Use ISO 639-1 for language identifier",
                      "type": "object",
                      "subNodePath": "titl",
                      "subNodeAttributes": [
                        {"subAttributeName": "xml:lang", "subRequired":  true}
                      ],
                      "subTargetFields": {"translationsPath": "title", "languagePath": "language/code"},
                      "subCallbackMethod": ["getMainTranslation"]
                    },
                    "datasetAdditionalTitles": {
                      "$comment": "Use ISO 639-1 for language identifier",
                      "type": "array",
                      "subNodePath": "parTitl",
                      "subNodeAttributes": [
                        {"subAttributeName": "xml:lang", "subRequired":  true}
                      ],
                      "subTargetFields": {"translationsPath": "title", "languagePath": "language/code"},
                      "subCallbackMethod": ["getAdditionalTranslations"],
                      "items": {
                        "type": "object"
                      }
                    },
                    "internalDatasetIdentifier": {
                      "type": "object",
                      "subNodePath": "IDNo",
                      "subNodeAttributes": [
                        {"subAttributeName": "agency", "subDefaultValue": "SWISSUbase"}
                      ],
                      "subCallbackMethod": ["getInternalIdentifier"]
                    },
                    "datasetDOI": {
                      "type": "object",
                      "subNodePath": "IDNo",
                      "subNodeAttributes": [
                        {"subAttributeName": "agency", "subDefaultValue": "DOI"}
                      ],
                      "subTargetFields": {"fieldPath": "doi"},
                      "subCallbackMethod": ["getFieldValue"]
                    }
                  }
                },
                "rspStmt": {
                  "type": "object",
                  "subNodePath": "rspStmt",
                  "required": ["authors"],
                  "properties": {
                    "authors": {
                      "type": "array",
                      "subNodePath": "AuthEnty",
                      "subCallbackMethod": ["getPIs"],
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                },
                "distStmt": {
                  "type": "object",
                  "subNodePath": "distStmt",
                  "required": ["publisher"],
                  "properties": {
                    "publisher": {
                      "type": "array",
                      "subNodePath": "distrbtr",
                      "subCallbackMethod": ["getPublisher"],
                      "subNodeAttributes": [
                        {"subAttributeName": "xml:lang", "subRequired":  true}
                      ],
                      "items": {
                        "type": "object"
                      }
                    },
                    "publicationDate": {
                      "type": "object",
                      "subNodePath": "distDate",
                      "subNodeAttributes": [
                        {"subAttributeName": "date", "subRequired":  true}
                      ],
                      "subCallbackMethod": ["getPublicationDate"]
                    }
                  }
                },
                "datasetURLs": {
                  "type": "object",
                  "subNodePath": "holdings",
                  "subNodeAttributes": [
                    {"subAttributeName": "URI", "subRequired": true},
                    {"subAttributeName": "xml:lang", "subDefaultValue": "en"}
                  ],
                  "subCallbackMethod": ["getDOI", "DOI_PROXY"]
                }
              }
            },
            "stdyInfo": {
              "type": "object",
              "subNodePath": "stdyInfo",
              "required": ["subject", "abstract", "sumDscr"],
              "properties": {
                "subject": {
                  "type": "object",
                  "subNodePath": "subject",
                  "required": ["topcClas"],
                  "properties": {
                    "topcClas": {
                      "type": "array",
                      "subNodePath": "topcClas",
                      "subNodeAttributes": [
                        {"subAttributeName": "xml:lang", "subRequired":  true}
                      ],
                      "subTargetFields": {"elements": "topicClasses"},
                      "subCallbackMethod": ["getElementsTranslation"],
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                },
                "abstract": {
                  "type": "array",
                  "subNodePath": "abstract",
                  "subNodeAttributes": [
                    {"subAttributeName": "xml:lang", "subRequired":  true}
                  ],
                  "subTargetFields": {"translationsPath": "abstract"},
                  "subCallbackMethod": ["getAllTranslations"],
                  "items": {
                    "type": "object"
                  }
                },
                "sumDscr": {
                  "type": "object",
                  "subNodePath": "sumDscr",
                  "required": ["nation"],
                  "properties": {
                    "nation": {
                      "type": "array",
                      "subNodePath": "nation",
                      "subNodeAttributes": [
                        {"subAttributeName": "xml:lang", "subRequired":  true}
                      ],
                      "subTargetFields": {"elements": "countries"},
                      "subCallbackMethod": ["getElementsTranslation"],
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            },
            "access": {
              "type": "object",
              "subNodePath": "dataAccs/useStmt",
              "required": ["restriction", "specialPermission"],
              "properties": {
                "restriction": {
                  "type": "array",
                  "subNodePath": "restrctn",
                  "subNodeAttributes": [
                    {"subAttributeName": "xml:lang", "subRequired":  true}
                  ],
                  "subTargetFields": {"element": "restriction"},
                  "subCallbackMethod": ["getElementTranslation"],
                  "items": {
                    "type": "object"
                  }
                },
                "specialPermission": {
                  "type": "array",
                  "subNodePath": "restrctn",
                  "subNodeAttributes": [
                    {"subAttributeName": "xml:lang", "subRequired":  true}
                  ],
                  "subTargetFields": {"element": "specialPermission"},
                  "subCallbackMethod": ["getElementTranslation"],
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "fileTxt": {
          "type": "object",
          "subNodePath": "fileDscr/fileTxt",
          "required": ["fileName"],
          "properties": {
            "fileName": {
              "type": "array",
              "subNodePath": "fileName",
              "subNodeAttributes": [
                {"subAttributeName": "xml:lang", "subRequired": true}
              ],
              "subTargetFields": {"objectListPath": "dataFiles", "fieldPath": "title"},
              "subCallbackMethod": ["getFileNames"],
              "items": {
                "type": "object"
              }
            }
          }
        }
      }
    }
  }
}